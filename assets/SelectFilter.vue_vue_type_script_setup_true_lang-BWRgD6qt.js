import{o as l,c as t,a as w,d as h,D as q,b as V,s as x,r as v,C as S,E as B,k as M,i as p,f as C,G as L,F as m,z as N,l as y,g as P,m as A,t as D}from"./index-DgqoaBW8.js";import{L as E}from"./RefreshButton.vue_vue_type_script_setup_true_lang-D0gOUg7D.js";function F(u,n){return l(),t("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[w("path",{"fill-rule":"evenodd",d:"M6.32 2.577a49.255 49.255 0 0 1 11.36 0c1.497.174 2.57 1.46 2.57 2.93V21a.75.75 0 0 1-1.085.67L12 18.089l-7.165 3.583A.75.75 0 0 1 3.75 21V5.507c0-1.47 1.073-2.756 2.57-2.93Z","clip-rule":"evenodd"})])}const K={key:0},T=["value"],$=["title"],j={key:1,class:"inline-block w-5"},O=h({__name:"SelectFilter",props:q({table:{},order_col:{default:null},ascending:{type:Boolean,default:!1},name_col:{},value_col:{}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(u){const n=V(),{preferences:f}=x(n);function g(a){return a in["latest_sqdc_stores","sqdc_brands","sqdc_inventory_daily","sqdc_inventory_daily_allstores","sqdc_inventory_daily_dates","sqdc_inventory_movements_daily","sqdc_performance_dates","sqdc_product_types","sqdc_skus","sqdc_suppliers","supplier_leaderboard"]}const e=u,c=v(!1),d=v(!1),o=S(u,"modelValue"),i=v([]),_=a=>{switch(a){case"supplier":return"defaultSupplier";case"number":return"defaultStore";case"brand":return"defaultBrand";case"type":return"defaultType";default:return"defaultSku"}},b=B(()=>o.value!==f.value[_(e.value_col)]&&["supplier","number","brand","type","sku"].includes(e.value_col)),k=async()=>{var s;d.value=!0;const a=f.value;if(((s=n.user)==null?void 0:s.id)===void 0){alert("You must be logged in to save preferences.");return}a[_(e.value_col)]=o.value;const{error:r}=await p.from("profiles").update({preferences:a}).eq("id",n.user.id);r&&alert(`Error saving preference: ${r.message}`),n.loadPreferences(),d.value=!1};return M(async()=>{var s;c.value=!0;let a=g(e.table)?p.from(e.table).select():p.from(e.table).select();e.order_col&&(a=a.order(e.order_col,{ascending:e.ascending}));const{data:r}=await a;i.value=r||void 0,o.value=o.value||((s=i.value)==null?void 0:s[0][e.value_col]),c.value=!1}),(a,r)=>(l(),t(m,null,[c.value?(l(),t("span",K,"Loading...")):C((l(),t("select",{key:1,class:"rounded-sm px-2 py-1","onUpdate:modelValue":r[0]||(r[0]=s=>o.value=s)},[(l(!0),t(m,null,N(i.value,s=>(l(),t("option",{key:s[e.value_col]||void 0,value:s[e.value_col]},D(s[e.name_col]),9,T))),128))],512)),[[L,o.value]]),b.value?(l(),t("span",{key:2,title:`Set ${o.value} as your default ${e.value_col}`,class:"flex flex-col justify-center rounded-sm bg-green-200 px-2 py-1 hover:bg-green-300"},[d.value===!1?(l(),t("button",{key:0,class:"inline-block w-5 underline",onClick:k},[y(P(F))])):(l(),t("span",j,[y(E)]))],8,$)):A("",!0)],64))}});export{O as _};
